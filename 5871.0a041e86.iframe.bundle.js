"use strict";(self.webpackChunkag_common=self.webpackChunkag_common||[]).push([[5871],{"./src/ui/components/OpenApiCodeBlock/OpenApiCodeBlock.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{L:()=>OpenApiCodeBlock});var jsx_runtime=__webpack_require__("./node_modules/.pnpm/react@19.1.0/node_modules/react/jsx-runtime.js"),emotion_styled_browser_esm=__webpack_require__("./node_modules/.pnpm/@emotion+styled@11.14.1_@emotion+react@11.14.0_@types+react@19.1.8_react@19.1.0__@types+react@19.1.8_react@19.1.0/node_modules/@emotion/styled/dist/emotion-styled.browser.esm.js"),FlexRow=(__webpack_require__("./node_modules/.pnpm/react@19.1.0/node_modules/react/index.js"),__webpack_require__("./src/ui/components/FlexRow/index.tsx")),array=__webpack_require__("./src/common/helpers/array.ts");const Highlight=emotion_styled_browser_esm.A.span`
  color: green;
`,Highlight2=emotion_styled_browser_esm.A.span`
  color: indianred;
`,getApiUrl=p=>p.schema.servers[0].url,getBodyJson=p=>{const body=p.funcF.toString(),bstart=((str,char,num=0)=>{let ret=-1;for(let c=0;c<=num;c+=1)ret=str.indexOf(char,ret+1);if(-1!==ret)return ret})(body,"(",1),bend=bstart?body.lastIndexOf(")"):void 0;if(!bstart||!bend)return;if(bend-bstart===1)return;const raw=body.substring(bstart+1,bend),cleaned=raw.replace(/([a-zA-Z0-9-]+[^"]):/gim,'"$1":').replace(/'/gim,'"');return{nice:JSON.stringify(JSON.parse(cleaned),null,2),raw}},getSecurity=(p,{operation})=>{const security1=operation.security?.[0],security2=security1?Object.keys(security1)[0]:void 0,security=security2?p.schema.components.securitySchemes[security2]:void 0;if(security)return"header"!==security.in?null:security},joinJsx=(items,sep)=>{const ret=[];return items.filter(array.z2).forEach((i,index)=>{if(ret.push(i),index!==items.length-1)for(const s of sep)ret.push(s)}),ret},getCurlLines=(ops,p)=>{const{operation,path,verb,fullApiUrl}=ops,withPath=fullApiUrl+path,secline=((p,{operation})=>{const sec=getSecurity(p,{operation});return null===sec?{error:"not supported sec in",content:void 0}:sec?{content:(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsx)("span",{children:"--header "}),(0,jsx_runtime.jsxs)(Highlight,{children:["'",sec.name,": ",(0,jsx_runtime.jsx)(Highlight2,{children:p.apiKey||"(API KEY)"}),"'"]})]})}:{content:void 0}})(p,{operation});if(secline.error)return{error:secline.error};const bodyLines=(p=>{const{nice}=getBodyJson(p)??{};return nice?{content:(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:["-d @- <<'EOF'",(0,jsx_runtime.jsx)("br",{}),(0,jsx_runtime.jsx)(Highlight2,{children:nice}),(0,jsx_runtime.jsx)("br",{}),"EOF"]}),header:(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsx)("span",{children:"--header "}),(0,jsx_runtime.jsx)(Highlight,{children:(0,jsx_runtime.jsx)(Highlight,{children:"'Content-Type: application/json'"})})]})}:{content:void 0,header:void 0}})(p),headerLines=[];return secline.content&&headerLines.push(secline.content),bodyLines.header&&headerLines.push(bodyLines.header),{verb,path,error:void 0,headerLines,fullApiUrl:withPath,bodyLine:bodyLines.content,operation}},Base=emotion_styled_browser_esm.A.div`
  white-space: pre;
`,Curl=({ops,p})=>{const{fullApiUrl,headerLines,bodyLine}=getCurlLines(ops,p),{verb}=ops,rows=[(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:["curl --request ",verb.toUpperCase()]}),(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:["--url ",(0,jsx_runtime.jsxs)(Highlight,{children:["'",fullApiUrl,"'"]})]}),...headerLines??[],bodyLine].filter(array.z2);return(0,jsx_runtime.jsx)(Base,{children:(items=rows,joinJsx(items,[(0,jsx_runtime.jsx)(jsx_runtime.Fragment,{children:" \\"}),(0,jsx_runtime.jsx)("br",{},"br1")]))});var items};Curl.__docgenInfo={description:"",methods:[],displayName:"Curl",props:{p:{required:!0,tsType:{name:"IOpenApiCodeBlock",elements:[{name:"TDefaultApi"}],raw:"IOpenApiCodeBlock<TDefaultApi>"},description:""},ops:{required:!0,tsType:{name:"IOpenApiOperationBlock"},description:""}}};const getFetchCall=(p,ops)=>(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsx)(Highlight,{children:"const"})," response = ",(0,jsx_runtime.jsx)(Highlight,{children:"await"})," ",(0,jsx_runtime.jsx)(Highlight2,{children:"fetch"}),"(",(0,jsx_runtime.jsxs)(Highlight,{children:["'",ops.fullApiUrl,"'"]}),",  requestOptions);"]});getFetchCall.__docgenInfo={description:"",methods:[],displayName:"getFetchCall",props:{schema:{required:!0,tsType:{name:"IOpenApi"},description:"openapi schema. eg\nconst schema: any = require('common/openapi.generated').default;"},apiKey:{required:!1,tsType:{name:"string"},description:""},funcF:{required:!0,tsType:{name:"signature",type:"function",raw:"(f: TDefaultApi) => Promise<any>",signature:{arguments:[{type:{name:"TDefaultApi"},name:"f"}],return:{name:"Promise",elements:[{name:"any"}],raw:"Promise<any>"}}},description:""}}};const rb=(0,jsx_runtime.jsx)(jsx_runtime.Fragment,{children:"}"}),lb=(0,jsx_runtime.jsx)(jsx_runtime.Fragment,{children:"{"}),Lpad=emotion_styled_browser_esm.A.div`
  padding-left: 0.5rem;
`,getRequestOptions=(p,ops)=>{const{nice}=getBodyJson(p)??{};if(!nice)return;const sec=getSecurity(p,ops),h1=(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[" ",(0,jsx_runtime.jsx)(Highlight,{children:"'Content-Type'"}),":"," ",(0,jsx_runtime.jsx)(Highlight,{children:"'application/json'"})]});let h2;sec&&(h2=(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[" ",(0,jsx_runtime.jsxs)(Highlight,{children:["'",sec.name,"'"]}),":"," ",(0,jsx_runtime.jsxs)(Highlight,{children:["'",p.apiKey||"(API KEY)","'"]})]}));const header=sec?(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:["headers: ",lb,(0,jsx_runtime.jsx)(Lpad,{children:(items=[h1,h2],joinJsx(items,[(0,jsx_runtime.jsx)(jsx_runtime.Fragment,{children:","}),(0,jsx_runtime.jsx)("br",{},"br1")]))}),rb,","]}):(0,jsx_runtime.jsx)(jsx_runtime.Fragment,{});var items;const body=(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:["body: ",(0,jsx_runtime.jsx)(Highlight2,{children:"JSON"}),".",(0,jsx_runtime.jsx)(Highlight,{children:"stringify"}),"(",nice,")"]});return(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:["const requestOptions = ",lb,(0,jsx_runtime.jsxs)(Lpad,{children:["method: ",(0,jsx_runtime.jsxs)(Highlight,{children:["'",ops.verb.toUpperCase(),"'"]}),",",(0,jsx_runtime.jsx)("br",{}),header,(0,jsx_runtime.jsx)("br",{}),body,(0,jsx_runtime.jsx)("br",{})]}),rb,";"]})};getRequestOptions.__docgenInfo={description:"",methods:[],displayName:"getRequestOptions",props:{schema:{required:!0,tsType:{name:"IOpenApi"},description:"openapi schema. eg\nconst schema: any = require('common/openapi.generated').default;"},apiKey:{required:!1,tsType:{name:"string"},description:""},funcF:{required:!0,tsType:{name:"signature",type:"function",raw:"(f: TDefaultApi) => Promise<any>",signature:{arguments:[{type:{name:"TDefaultApi"},name:"f"}],return:{name:"Promise",elements:[{name:"any"}],raw:"Promise<any>"}}},description:""}}};const fetch_Base=emotion_styled_browser_esm.A.div`
  white-space: pre;
`,Fetch=({ops,p})=>{const{reqContent}=((ops,p)=>{const{operation,path,verb,fullApiUrl}=ops;return{verb,path,error:void 0,fullApiUrl:fullApiUrl+path,reqContent:getRequestOptions(p,ops)??void 0,operation}})(ops,p),x=getFetchCall(0,ops);return(0,jsx_runtime.jsxs)(fetch_Base,{children:[reqContent,(0,jsx_runtime.jsx)("br",{}),(0,jsx_runtime.jsx)("br",{}),x]})};Fetch.__docgenInfo={description:"",methods:[],displayName:"Fetch",props:{p:{required:!0,tsType:{name:"IOpenApiCodeBlock",elements:[{name:"TDefaultApi"}],raw:"IOpenApiCodeBlock<TDefaultApi>"},description:""},ops:{required:!0,tsType:{name:"IOpenApiOperationBlock"},description:""}}};const OpenApiCodeBlock_Base=emotion_styled_browser_esm.A.div`
  display: flex;
  flex-flow: column;
  width: calc(100% - 2rem);
  flex-grow: 1;
  border: solid 1px #333;
  padding: 1rem;
  overflow-y: auto;
  max-height: calc(100% - 2rem);
`,Verb=emotion_styled_browser_esm.A.div`
  background-color: #333;
  color: white;
  margin-right: 0.5rem;
  padding: 0.25rem;
  font-size: 0.8rem;
`,ApiName=emotion_styled_browser_esm.A.div`
  font-weight: bold;
  font-size: 1.5rem;
`,BlockTitle=emotion_styled_browser_esm.A.div`
  color: #333;
  font-size: 1.2rem;
  margin-top: 2rem;
`,Block=emotion_styled_browser_esm.A.div`
  background-color: rgba(0, 0, 0, 0.1);
  padding: 1rem;
  margin-top: 0.5rem;
`,OpenApiCodeBlock=p=>{const ops=(p=>{let path,verb;const func=(p=>{let ret=p.funcF.toString();const i1=ret.indexOf(".")+1,i2=ret.indexOf("(",i1);return ret=ret.substring(i1,i2),ret})(p);return Object.entries(p.schema.paths).forEach(([pathN,ops])=>Object.entries(ops).forEach(([verbN,op])=>{op.operationId!==func&&op.operationId+"Raw"!==func||(path=pathN,verb=verbN)})),path&&verb?{operation:p.schema.paths[path][verb],verb,path,fullApiUrl:getApiUrl(p)}:{error:"operation not found"}})(p);if(ops.error||!ops.verb||!ops.operation)return(0,jsx_runtime.jsx)(OpenApiCodeBlock_Base,{children:ops.error});const{verb,operation,path}=ops;return(0,jsx_runtime.jsxs)(OpenApiCodeBlock_Base,{children:[(0,jsx_runtime.jsxs)(FlexRow.Y,{center:!0,noGrow:!0,children:[(0,jsx_runtime.jsx)(Verb,{children:verb}),(0,jsx_runtime.jsx)(ApiName,{children:operation.description??path})]}),(0,jsx_runtime.jsx)(BlockTitle,{children:"Definition"}),(0,jsx_runtime.jsxs)(Block,{children:[verb.toUpperCase()," ",path]}),(0,jsx_runtime.jsx)(BlockTitle,{children:"Example curl Request"}),(0,jsx_runtime.jsx)(Block,{children:(0,jsx_runtime.jsx)(Curl,{ops,p})}),(0,jsx_runtime.jsx)(BlockTitle,{children:"Example fetch Request"}),(0,jsx_runtime.jsx)(Block,{children:(0,jsx_runtime.jsx)(Fetch,{ops,p})})]})};OpenApiCodeBlock.__docgenInfo={description:"",methods:[],displayName:"OpenApiCodeBlock",props:{schema:{required:!0,tsType:{name:"IOpenApi"},description:"openapi schema. eg\nconst schema: any = require('common/openapi.generated').default;"},apiKey:{required:!1,tsType:{name:"string"},description:""},funcF:{required:!0,tsType:{name:"signature",type:"function",raw:"(f: TDefaultApi) => Promise<any>",signature:{arguments:[{type:{name:"TDefaultApi"},name:"f"}],return:{name:"Promise",elements:[{name:"any"}],raw:"Promise<any>"}}},description:""}}}}}]);
//# sourceMappingURL=5871.0a041e86.iframe.bundle.js.map