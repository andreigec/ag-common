"use strict";(self.webpackChunkag_common=self.webpackChunkag_common||[]).push([[6018],{"./src/ui/components/BarChart/index.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{E:()=>BarChart});var emotion_styled_browser_esm=__webpack_require__("./node_modules/.pnpm/@emotion+styled@11.11.5_@emotion+react@11.11.4_@types+react@18.3.3_react@18.3.1__@types+react@18.3.3_react@18.3.1/node_modules/@emotion/styled/dist/emotion-styled.browser.esm.js"),react=__webpack_require__("./node_modules/.pnpm/react@18.3.1/node_modules/react/index.js"),useTooltip=__webpack_require__("./src/ui/helpers/useTooltip.tsx"),common=__webpack_require__("./src/ui/styles/common.tsx"),styles=__webpack_require__("./src/ui/styles/index.ts");function _tagged_template_literal(strings,raw){return raw||(raw=strings.slice(0)),Object.freeze(Object.defineProperties(strings,{raw:{value:Object.freeze(raw)}}))}function _templateObject(){var data=_tagged_template_literal(["\n  display: flex;\n  flex-flow: row;\n  width: 100%;\n  height: 100%;\n  cursor: default;\n  position: relative;\n"]);return _templateObject=function _templateObject(){return data},data}function _templateObject1(){var data=_tagged_template_literal(["\n  position: absolute;\n  left: 0.25rem;\n"]);return _templateObject1=function _templateObject(){return data},data}var Base=emotion_styled_browser_esm.A.div(_templateObject()),Title=emotion_styled_browser_esm.A.div(_templateObject1()),Item=function(param){var data=param.data,className=param.className,onMouseMove=param.onMouseMove,onMouseLeave=param.onMouseLeave,maxWidth=param.maxWidth,style=param.style;return react.createElement(Base,{className,onMouseMove,onMouseLeave,style,"data-type":"bcb-item"},react.createElement(Title,{style:{color:style.color,filter:(0,styles.W6)(style.backgroundColor)}},data.name),data.values.map((function(v){return react.createElement("div",{"data-barchartitem-key":v.name,key:v.name,style:{height:"100%",width:"".concat(v.value/maxWidth*100,"%"),backgroundColor:v.colour}}," ")})),react.createElement("div",{style:{height:"100%",flexGrow:1,backgroundColor:"transparent"}}," "))};Item.__docgenInfo={description:"",methods:[],displayName:"Item",props:{data:{required:!0,tsType:{name:"IBarChartData"},description:""},className:{required:!1,tsType:{name:"string"},description:""},onMouseMove:{required:!1,tsType:{name:"MouseEventHandler",elements:[{name:"HTMLDivElement"}],raw:"MouseEventHandler<HTMLDivElement>"},description:""},onMouseLeave:{required:!1,tsType:{name:"MouseEventHandler",elements:[{name:"HTMLDivElement"}],raw:"MouseEventHandler<HTMLDivElement>"},description:""},maxWidth:{required:!0,tsType:{name:"number"},description:""},style:{required:!0,tsType:{name:"IVarStyles"},description:""}}};var array=__webpack_require__("./src/common/helpers/array.ts"),math=__webpack_require__("./src/common/helpers/math.ts"),getLegendItems=function(param){var data=param.data,selectedKey=param.selectedKey,min=.1*data.total,part=(0,array.s)(data.values.filter((function(r){return r.value>min})),4).part,rest=JSON.parse(JSON.stringify(data.values)).filter((function(r){return!part.find((function(p){return p.name===r.name}))}));if(selectedKey){var pi=part.findIndex((function(r){return r.name===selectedKey})),ri=rest.findIndex((function(r){return r.name===selectedKey}));-1===pi&&-1!==ri&&(part.push(rest[ri]),rest.splice(ri,1))}var restTotal=(0,math.RM)(rest.map((function(s){return s.value})));return{part,rest,restTotal}};function Legend_tagged_template_literal(strings,raw){return raw||(raw=strings.slice(0)),Object.freeze(Object.defineProperties(strings,{raw:{value:Object.freeze(raw)}}))}function Legend_templateObject(){var data=Legend_tagged_template_literal(["\n  display: flex;\n  flex-flow: column;\n"]);return Legend_templateObject=function _templateObject(){return data},data}function Legend_templateObject1(){var data=Legend_tagged_template_literal(["\n  width: 100%;\n  height: 1rem;\n  display: flex;\n  flex-flow: row;\n  position: relative;\n  margin-bottom: 0.25rem;\n"]);return Legend_templateObject1=function _templateObject(){return data},data}function _templateObject2(){var data=Legend_tagged_template_literal(["\n  position: absolute;\n  top: calc(50% - 1px);\n  height: 2px;\n  left: 0;\n  right: 0;\n"]);return _templateObject2=function _templateObject(){return data},data}function _templateObject3(){var data=Legend_tagged_template_literal(["\n  width: 100%;\n  height: 1rem;\n  display: flex;\n  flex-flow: row;\n  justify-content: space-between;\n  z-index: 1;\n"]);return _templateObject3=function _templateObject(){return data},data}function _templateObject4(){var data=Legend_tagged_template_literal(["\n  width: 100%;\n  display: flex;\n  flex-flow: row wrap;\n  position: relative;\n  justify-content: space-between;\n"]);return _templateObject4=function _templateObject(){return data},data}function _templateObject5(){var data=Legend_tagged_template_literal(["\n  display: flex;\n  flex-flow: row;\n  position: relative;\n  align-items: center;\n  flex-basis: 25%;\n"]);return _templateObject5=function _templateObject(){return data},data}function _templateObject6(){var data=Legend_tagged_template_literal(["\n  width: 1rem;\n  height: 1rem;\n  border-radius: 50%;\n  margin-right: 0.25rem;\n"]);return _templateObject6=function _templateObject(){return data},data}var Legend_Base=emotion_styled_browser_esm.A.div(Legend_templateObject()),Bar=emotion_styled_browser_esm.A.div(Legend_templateObject1()),Line=emotion_styled_browser_esm.A.div(_templateObject2()),Numbers=emotion_styled_browser_esm.A.div(_templateObject3()),Items=emotion_styled_browser_esm.A.div(_templateObject4()),Legend_Item=emotion_styled_browser_esm.A.div(_templateObject5()),Col=emotion_styled_browser_esm.A.div(_templateObject6()),Legend=function(param){var data=param.data,maxWidth=param.maxWidth,style=param.style,items=[0];maxWidth>10&&(items.push(Math.floor(.25*maxWidth)),items.push(Math.floor(.5*maxWidth)),items.push(Math.floor(.75*maxWidth))),items.push(maxWidth);var keys=(0,array.ey)((0,array.Ct)(data.map((function(data){return getLegendItems({data}).part.map((function(v){return{colour:v.colour,name:v.name}}))}))),(function(s){return s.name})).sort((function(a,b){return a.name<b.name?-1:1}));return react.createElement(Legend_Base,{style},react.createElement(Bar,null,react.createElement(Line,{style:{background:style.backgroundColor,color:style.color}}),react.createElement(Numbers,null,items.map((function(i){return react.createElement("span",{style:{backgroundColor:style.backgroundColor,color:style.color},key:i},i)})))),keys.length>1&&react.createElement(Items,null,keys.map((function(k){return react.createElement(Legend_Item,{key:k.name},react.createElement(Col,{style:{backgroundColor:k.colour}}),k.name)}))))};function _define_property(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}function _object_spread(target){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{},ownKeys=Object.keys(source);"function"==typeof Object.getOwnPropertySymbols&&(ownKeys=ownKeys.concat(Object.getOwnPropertySymbols(source).filter((function(sym){return Object.getOwnPropertyDescriptor(source,sym).enumerable})))),ownKeys.forEach((function(key){_define_property(target,key,source[key])}))}return target}function _object_spread_props(target,source){return source=null!=source?source:{},Object.getOwnPropertyDescriptors?Object.defineProperties(target,Object.getOwnPropertyDescriptors(source)):function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);enumerableOnly&&(symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}))),keys.push.apply(keys,symbols)}return keys}(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))})),target}function TooltipContent_tagged_template_literal(strings,raw){return raw||(raw=strings.slice(0)),Object.freeze(Object.defineProperties(strings,{raw:{value:Object.freeze(raw)}}))}function TooltipContent_templateObject(){var data=TooltipContent_tagged_template_literal(["\n  padding: 0.5rem;\n"]);return TooltipContent_templateObject=function _templateObject(){return data},data}function TooltipContent_templateObject1(){var data=TooltipContent_tagged_template_literal(["\n  font-weight: bold;\n"]);return TooltipContent_templateObject1=function _templateObject(){return data},data}function TooltipContent_templateObject2(){var data=TooltipContent_tagged_template_literal(["\n  width: 100%;\n  display: flex;\n"]);return TooltipContent_templateObject2=function _templateObject(){return data},data}function TooltipContent_templateObject3(){var data=TooltipContent_tagged_template_literal(["\n  &[data-selected='true'] {\n    font-weight: bold;\n    text-decoration: underline;\n  }\n"]);return TooltipContent_templateObject3=function _templateObject(){return data},data}function TooltipContent_templateObject4(){var data=TooltipContent_tagged_template_literal(["\n  margin-left: auto;\n  padding-left: 0.5rem;\n\n  &[data-selected='true'] {\n    font-weight: bold;\n    text-decoration: underline;\n  }\n"]);return TooltipContent_templateObject4=function _templateObject(){return data},data}Legend.__docgenInfo={description:"",methods:[],displayName:"Legend",props:{data:{required:!0,tsType:{name:"Array",elements:[{name:"IBarChartData"}],raw:"IBarChartData[]"},description:""},maxWidth:{required:!0,tsType:{name:"number"},description:""},style:{required:!0,tsType:{name:"IVarStyles"},description:""}}};var TooltipContent_Base=emotion_styled_browser_esm.A.div(TooltipContent_templateObject()),TooltipContent_Title=emotion_styled_browser_esm.A.div(TooltipContent_templateObject1()),Row=emotion_styled_browser_esm.A.div(TooltipContent_templateObject2()),ItemTitle=emotion_styled_browser_esm.A.span(TooltipContent_templateObject3()),Total=emotion_styled_browser_esm.A.span(TooltipContent_templateObject4()),TooltipContent=function(param){var data=param.data,selectedKey=param.selectedKey,style=param.style,_getLegendItems=getLegendItems({data,selectedKey}),part=_getLegendItems.part,rest=_getLegendItems.rest,restTotal=_getLegendItems.restTotal;return react.createElement(TooltipContent_Base,{style:_object_spread_props(_object_spread({},style),{border:"solid 1px ".concat(style.borderColor)})},react.createElement(TooltipContent_Title,null,data.name),react.createElement(Row,null,react.createElement("span",null,"total"),react.createElement(Total,null,data.total)),part.map((function(v){return react.createElement(Row,{style:{color:v.colour},key:v.name},react.createElement(ItemTitle,{"data-selected":selectedKey===v.name},v.name),react.createElement(Total,{"data-selected":selectedKey===v.name},v.value))})),rest.length>0&&react.createElement(Row,null,react.createElement("span",null,rest.length," more"),react.createElement(Total,null,restTotal)))};function _array_like_to_array(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function Base_define_property(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}function Base_object_spread_props(target,source){return source=null!=source?source:{},Object.getOwnPropertyDescriptors?Object.defineProperties(target,Object.getOwnPropertyDescriptors(source)):function Base_ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);enumerableOnly&&(symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}))),keys.push.apply(keys,symbols)}return keys}(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))})),target}function Base_tagged_template_literal(strings,raw){return raw||(raw=strings.slice(0)),Object.freeze(Object.defineProperties(strings,{raw:{value:Object.freeze(raw)}}))}function _to_consumable_array(arr){return function _array_without_holes(arr){if(Array.isArray(arr))return _array_like_to_array(arr)}(arr)||function _iterable_to_array(iter){if("undefined"!=typeof Symbol&&null!=iter[Symbol.iterator]||null!=iter["@@iterator"])return Array.from(iter)}(arr)||function _unsupported_iterable_to_array(o,minLen){if(!o)return;if("string"==typeof o)return _array_like_to_array(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _array_like_to_array(o,minLen)}(arr)||function _non_iterable_spread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Base_templateObject(){var data=Base_tagged_template_literal(["\n  display: flex;\n  flex-flow: column;\n  width: 100%;\n  height: 100%;\n  margin-top: 0.5rem;\n  position: relative;\n"]);return Base_templateObject=function _templateObject(){return data},data}function Base_templateObject1(){var data=Base_tagged_template_literal(["\n  margin-bottom: 0.75rem;\n\n  &:last-of-type {\n    margin-bottom: 0;\n  }\n"]);return Base_templateObject1=function _templateObject(){return data},data}TooltipContent.__docgenInfo={description:"",methods:[],displayName:"TooltipContent",props:{data:{required:!0,tsType:{name:"IBarChartData"},description:""},selectedKey:{required:!1,tsType:{name:"string"},description:""},style:{required:!0,tsType:{name:"IVarStyles"},description:""}}};var BarChartBase=emotion_styled_browser_esm.A.div(Base_templateObject()),ItemStyled=(0,emotion_styled_browser_esm.A)(Item)(Base_templateObject1()),BarChart=function(param){var _Math,dataRaw=param.data,sRaw=param.style,className=param.className,style=(0,common.QS)(sRaw),UT=(0,useTooltip.f)(),maxWidth=(_Math=Math).max.apply(_Math,_to_consumable_array(dataRaw.map((function(a){return a.total}))));return react.createElement(BarChartBase,{"data-type":"bcb",style,className},react.createElement(UT.Comp,{pos:UT.pos},(function(param){var data=param.data;return react.createElement(TooltipContent,Base_object_spread_props(function Base_object_spread(target){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{},ownKeys=Object.keys(source);"function"==typeof Object.getOwnPropertySymbols&&(ownKeys=ownKeys.concat(Object.getOwnPropertySymbols(source).filter((function(sym){return Object.getOwnPropertyDescriptor(source,sym).enumerable})))),ownKeys.forEach((function(key){Base_define_property(target,key,source[key])}))}return target}({},data),{style}))})),dataRaw.map((function(data){return react.createElement(ItemStyled,{style,key:data.name,data,maxWidth,onMouseLeave:function(){return UT.setPos(void 0)},onMouseMove:function(element){var _document_elementFromPoint,_document_elementFromPoint_getAttribute,selectedKey=null!==(_document_elementFromPoint_getAttribute=null===(_document_elementFromPoint=document.elementFromPoint(element.pageX,element.pageY))||void 0===_document_elementFromPoint?void 0:_document_elementFromPoint.getAttribute("data-barchartitem-key"))&&void 0!==_document_elementFromPoint_getAttribute?_document_elementFromPoint_getAttribute:"";UT.setPos({element,parent:element.currentTarget.closest("[data-type='bcb']"),data:{selectedKey,data}})}})})),react.createElement(Legend,{data:dataRaw,maxWidth,style}))};BarChart.__docgenInfo={description:"",methods:[],displayName:"BarChart",props:{data:{required:!0,tsType:{name:"Array",elements:[{name:"IBarChartData"}],raw:"IBarChartData[]"},description:""},style:{required:!1,tsType:{name:"Partial",elements:[{name:"IVarStyles"}],raw:"Partial<IVarStyles>"},description:""},className:{required:!1,tsType:{name:"string"},description:""}}}}}]);